<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<style>
			body {
				background-color: transparent;
			}
			
			#model {
				display: flex;
			    	justify-content: center;
			}
		</style>
	</head>

	<body>

		<div id="model"></div>

	<script async src="https://unpkg.com/es-module-shims@1.3.6/dist/es-module-shims.js"></script>

	<script type="importmap">
		{
			"imports": {
				"three": "/three.js-master/build/three.module.js"
			}
		}
	</script>

	<script type="module">

		import * as THREE from 'three';

		//import Stats from './jsm/libs/stats.module.js';

		import { OrbitControls } from '/three.js-master/examples/jsm/controls/OrbitControls.js';
		import { RoomEnvironment } from '/three.js-master/examples/jsm/environments/RoomEnvironment.js';

		import { GLTFLoader } from '/three.js-master/examples/jsm/loaders/GLTFLoader.js';
		import { DRACOLoader } from '/three.js-master/examples/jsm/loaders/DRACOLoader.js';

		let mixer;

		const clock = new THREE.Clock();
		const container = document.getElementById('model');

		//const stats = new Stats();
		//container.appendChild(stats.dom);

		const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
		renderer.setClearColor(0x000000, 0);
		renderer.setPixelRatio(window.devicePixelRatio);
		renderer.setSize(300, 300);
		renderer.outputEncoding = THREE.sRGBEncoding;
		container.appendChild(renderer.domElement);

		const pmremGenerator = new THREE.PMREMGenerator(renderer);

		const scene = new THREE.Scene();
		//scene.background = new THREE.Color(0xbfe3dd);
		scene.environment = pmremGenerator.fromScene(new RoomEnvironment(), 0.04).texture;

		const camera = new THREE.PerspectiveCamera(40, 300 / 300, 1, 100);
		camera.position.set(5, 4, 10);

		const controls = new OrbitControls(camera, renderer.domElement);
		controls.target.set(0, 0.5, 0);
		controls.update();
		controls.enablePan = false;
		controls.enableDamping = true;
		controls.enableZoom = false;

		controls.autoRotate = true;
		controls.autoRotateSpeed = 2.0;

		const dracoLoader = new DRACOLoader();
		dracoLoader.setDecoderPath('/js/libs/draco/gltf/');

		const loader = new GLTFLoader();
		loader.setDRACOLoader( dracoLoader );
		loader.load('/three.js-master/examples/models/gltf/LittlestTokyo.glb', function (gltf) {

			const model = gltf.scene;
			model.position.set(1, 1, 0);
			model.scale.set(0.01, 0.01, 0.01);
			scene.add(model);

			mixer = new THREE.AnimationMixer(model);
			mixer.clipAction(gltf.animations[0]).play();

			animate();

		}, undefined, function(e) {

			console.error(e);

		} );


		window.onresize = function () {

			camera.aspect = 300 / 30;
			camera.updateProjectionMatrix();

			renderer.setSize(300, 300);

		};


		function animate() {

			requestAnimationFrame(animate);

			const delta = clock.getDelta();

			mixer.update(delta);

			controls.update();

			//stats.update();

			renderer.render(scene, camera);

		}


	</script>
	</body>

</html>
